---
layout: post
title: ld.lld and linker files
---

LLVM's linker was a real pain. But I know now how to use it.

# LLVM linker (ld.lld-5.0)

To get my STM32 to run I have to tell the linker where to store the executable data.

This is usually done with a linker file. But unfortunately `ld.lld` doesn't support the same gcc-linker format.

## Memory definition

We first start with the memory definition file

STM32-linker/STM32F3/STM32F303VC.ld
```
MEMORY{
	RAM    (xrw)  : ORIGIN = 0x20000000, LENGTH = 40K
	FLASH  (rx)   : ORIGIN = 0x08000000, LENGTH = 256K
	CCMRAM (xrw)  : ORIGIN = 0x10000000, LENGTH = 8K
}
```

The STM32F303VC6 which is used in the STM32F3Discovery board is defined by this (mem) linker file.
We see that this Chip has a `RAM` region in `0x20000000` which is 40KB long and used for saving variables and the stack.
Also it has a `FLASH` region for the program code at the adress `0x0800000` which is 256KB long.
And we just ignore the `CCMRAM`.

## (simple) linker file
